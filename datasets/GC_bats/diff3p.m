function y = diff3p(x,fs)

% 三点微分 
% 
% xは2次元目（縦方向）が時系列のベクトルまたは2次元配列
% 
% 

%% main code
y = x ; % 出力引数の初期化
y(1,:) = (-3*x(1,:) + 4*x(2,:) - x(3,:))/(2/fs)  ;         % 一点目
y(2:end-1,:) = (-x(1:end-2,:) + x(3:end,:))/(2/fs) ;       % 真ん中
y(end,:) = (x(end-2,:) - 4*x(end-1,:) +3*x(end,:))/(2/fs) ; % 終点


